<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroC Numerical Implementation</title>
    <meta name="description" content="">
    <head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  
  
  
  
   
   
   
   

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/members.css">
  <link rel="stylesheet" href="/css/single.css"> 
  <link rel="stylesheet" href="/css/back2top.css"> 
  <link rel="stylesheet" href="/css/dropdown.css"> 
  <link rel="stylesheet" href="/css/research-areas.css">
 
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
</head>
    
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>  
</head>
<body>        
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  
  <a class="navbar-brand" href="https://www.phenorobdaa.de/">
      <img src="/images/DAA.png" alt="Logo" style="max-height: 75px;">
  </a>

  <div class="d-flex flex-grow-1 justify-content-center d-none d-md-block">
    <div class="text-center">
        <h1 class="mb-0 display-4">PhenoRob Digital Agricultural Avatar (DAA)</h1>
        <h2 class="h5 mb-0">(Process Based Models for the Future of Crop Production)</h2>
    </div>
  </div>


  
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
  </button>

  
  <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
      <ul class="navbar-nav ml-auto">
          
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="link2Dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  DAA
              </a>
              <div class="dropdown-menu" aria-labelledby="link2Dropdown">
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//about/">About</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//videos/">Videos</a>
                  
              </div>
          </li>

          
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="toolsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Modelling
              </a>
              <div class="dropdown-menu" aria-labelledby="toolsDropdown">
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//tools/">Our Main Tools</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//couple/">Coupled Models</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//tools-dev/">Developer Zone</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//theory/">Theoritical Zone</a>
                  
              </div>
          </li>

            
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="link1Dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Research
            </a>
            <div class="dropdown-menu" aria-labelledby="link1Dropdown">
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//research-areas/">Research Area</a>
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//members/">Research Team</a>
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//publication/">Publications</a>
                
            </div>
            </li>

          
           <li class="nav-item">
              <a class="nav-link" href="/members/" target="_blank">Contact</a>
           </li>
      </ul>
  </div>
</nav>
    
    <main>
        
         
         <script src="https://www.phenorobdaa.de/js/slider.js"></script> 
        
<style>
  .book-sidebar {
    position: fixed;
    top: 100px;
    left: 0;
    width: 250px;
    height: 100vh;
    overflow-y: auto;
    padding: 1rem;
    border-right: 1px solid #ccc;
  }

  @media (max-width: 768px) {
    .book-sidebar {
      width: 0;
      border-right: none;
    }
  }

  .book-content {
      margin-left: 270px;
      padding: 1rem;
      padding-right: calc(10px + 2vw);
  }

  @media (min-width: 992px) {
      .book-content {
          padding-right: 200px;
      }
  }

  @media (max-width: 768-px) {
      .book-content {
          padding-right: 50px;
      }
  }

  .card {
    margin-bottom: 2rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .figure img {
    max-width: 80%;
    height: auto;
  }

  .figure-caption {
    margin-top: 0.5rem;
    font-style: italic;
  }
</style>

<div class="container-fluid mt-5">
  <div class="row">
    
    <div class="col-md-3 book-sidebar">
      <h4 class="sidebar-heading">Contents</h4>
      <ul class="nav flex-column">
        
        <li class="nav-item">
          <a class="nav-link" href="#water-flow-richards-equation">Water Flow: Richard&#39;s Equation</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#discretization-of-richards-equation">Discretization of Richard&#39;s Equation</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#richards-solver">Richard&#39;s Solver</a>
        </li>
        
      </ul>
    </div>

    
    <div class="col-md-9 ml-auto book-content">
      
      <section id="water-flow-richards-equation" class="card">
        <div class="card-body">
          <h2 class="card-title">Water Flow: Richard&#39;s Equation</h2>
          <div class="card-text"><p>In the Watflow module of AgroC, Richard&rsquo;s equation is solved to simulate how water moves through unsaturated soils. In terms of water content, this equation can be written as:
$$
\frac{\partial \theta}{\partial t} = \nabla \cdot (K(h) \nabla h) + S
$$
where,</p>
<ul>
<li>\(\theta\) is the volumetric water content (dimensionless, typically expressed as m³/m³);</li>
<li>\(h\) is the hydraulic head (units: L, typically meters);</li>
<li>\(t\) represents time (seconds or days);</li>
<li>\(K(h)\) is the hydraulic conductivity, a function of the hydraulic head (units: L/T, typically m/s);</li>
<li>\(S\) represents sources or sinks of water such as root water uptake or irrigation (units: L³/L³/T, typically m³/m³/s);</li>
<li>The spatial derivatives are approximated using finite differences and the temporal derivative is handled via an implicit time-stepping method.</li>
</ul>
<p>In AgroC, we solve this equation by using advanced numerical techniques like Picard iteration for non-linear convergence and a Gauss-Siedel elimination technique to solve the resulting linear system of equations.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="discretization-of-richards-equation" class="card">
        <div class="card-body">
          <h2 class="card-title">Discretization of Richard&#39;s Equation</h2>
          <div class="card-text"><p>Richard&rsquo;s equation is numerically approximated using a finite difference method (FDM) for spatial discretization and an implicit time-stepping method for temporal discretization. Here is the detailed breakdown:</p>
<h4 id="finite-difference-method-fdm">Finite Difference Method (FDM)</h4>
<p>The differential equation:
$$
\frac{\partial \theta}{\partial t} = \nabla \cdot (K(h) \nabla h) + S
$$
is discretized for a computational grid point (i) as follows:
$$
\frac{\theta_i^{n+1} - \theta_i^n}{\Delta t} = \frac{K_{i+1/2}^{n+1} (h_{i+1}^{n+1} - h_i^{n+1}) - K_{i-1/2}^{n+1} (h_i^{n+1} - h_{i-1}^{n+1})}{\Delta z^2} + S_i
$$
where:</p>
<ul>
<li>\(K_{i+1/2}^{n+1}\) and \(K_{i-1/2}^{n+1}\) represent the hydraulic conductivity values interpolated between nodes,</li>
<li>\(\Delta z\) is the distance between adjacent nodes (vertical discretization),</li>
<li>\(S_i\) is the source or sink term at node (i), including effects like root water uptake or irrigation.</li>
</ul>
<h4 id="handling-of-hydraulic-conductivity">Handling of Hydraulic Conductivity</h4>
<p>Hydraulic conductivity (K(h)) is a key non-linear component in Richard&rsquo;s equation and is dependent on the hydraulic head (h). In the discretization:
$$
K_{i+1/2}^{n+1} = \frac{K(h_{i+1}^{n+1}) + K(h_i^{n+1})}{2}
$$</p>
<h4 id="time-discretization">Time Discretization</h4>
<p>Time discretization is handled implicitly to ensure stability, especially given the non-linear nature of the soil moisture properties. The backward Euler method is used:
$$
\frac{\theta_{i}^{n+1} - \theta_{i}^n}{\Delta t}
$$</p>
<ul>
<li>where \(n\) indicates the time level.</li>
</ul>
<h4 id="picard-iteration-for-linearization">Picard Iteration for Linearization</h4>
<p>To manage the non-linear relationship between hydraulic head and hydraulic conductivity, Picard iteration is utilized:
$$
h_i^{n+1,k+1} = h_i^{n+1,k} + \Delta t \left( \nabla \cdot (K(h_i^{n+1,k}) \nabla h_i^{n+1,k}) + S_i \right)
$$</p>
<ul>
<li>Here, (k) represents the Picard iteration step within each time step, refining the head approximation iteratively until convergence.</li>
</ul>
</div>
          
          
        </div>
      </section>
      
      <section id="richards-solver" class="card">
        <div class="card-body">
          <h2 class="card-title">Richard&#39;s Solver</h2>
          <div class="card-text"><h4 id="gauss-elimination-for-linear-systems">Gauss Elimination for Linear Systems</h4>
<p>Gauss elimination is employed to solve linear systems formed from the finite difference discretization of Richard&rsquo;s equation. Here&rsquo;s a comprehensive step-by-step description of the entire Gauss elimination process, including the explicit definition and formation of matrix (A):</p>
<h5 id="formation-of-matrix-a">Formation of Matrix (A)</h5>
<p>Matrix (A) is formed from the discretization of Richard&rsquo;s equation. It consists of coefficients that account for the hydraulic conductivity between nodes and the storage or capacitance of each node:</p>
<ul>
<li>
<p>Diagonal Entries (Aii): These entries are formed based on the local node&rsquo;s hydraulic conductivity and its soil water capacitance. For node (i), the diagonal entry Aii is given by:
$$
A_{ii} = \frac{K_{i+1/2} + K_{i-1/2}}{\Delta z} + \frac{\text{Cap}_i \cdot \Delta z}{\Delta t}
$$
where:</p>
<ul>
<li>\(K_{i+1/2}\) and \(K_{i-1/2}\) are the conductivities at the interfaces with adjacent nodes,</li>
<li>\(\Delta z\) is the spatial discretization step,</li>
<li>\(\Delta t\) is the time step,</li>
<li>\(\text{Cap}_i\) is the soil water capacitance at node (i).</li>
</ul>
</li>
<li>
<p>Off-Diagonal Entries Aij: These entries represent the fluxes between node (i) and its adjacent nodes due to hydraulic conductivity:
$$
A_{i,i+1} = -\frac{K_{i+1/2}}{\Delta z}, \quad A_{i,i-1} = -\frac{K_{i-1/2}}{\Delta z}
$$
These terms account for the influence of neighboring nodes on node (i).</p>
</li>
</ul>
<h5 id="formation-of-vector-b">Formation of Vector (b)</h5>
<p>Vector (b) accounts for the water content changes and external sources or sinks at each node:
$$
b_i = \text{Cap}_i \cdot \frac{\theta_i^n}{\Delta t} + S_i \cdot \Delta z + \text{Boundary Contributions}
$$
Here, \(\theta_i^n\) is the previous time step&rsquo;s water content, and \(S_i\) represents sources or sinks such as root uptake or irrigation.</p>
<p><strong>Boundary Conditions:</strong></p>
<ul>
<li><strong>Top Boundary:</strong> Modify the first row of \(A\) and \(b\) depending on specified atmospheric or flux conditions.</li>
<li><strong>Bottom Boundary:</strong> Modify the last row of \(A\) and \(b\) based on seepage or bottom flux conditions.</li>
</ul>
<h5 id="forward-elimination-and-back-substitution">Forward Elimination and Back Substitution</h5>
<p>The solution process involves:</p>
<ul>
<li><strong>Forward Elimination:</strong> Modifying matrix \(A\) to upper triangular form and adjusting vector (b) to reflect these transformations, preparing for back substitution.
$$
\text{For each } i \text{ from 3 to } N-1:
\quad \text{if } |A_{i-1,i-1}| &gt; \epsilon:
\quad \quad b_i = b_i - \frac{b_{i-1} \cdot A_{i,i-1}}{A_{i-1,i-1}}
\quad \quad A_{ii} = A_{ii} - \frac{A_{i,i-1}^2}{A_{i-1,i-1}}
\quad \text{else}:
\quad \quad \text{Print exception}
$$</li>
<li><strong>Back Substitution:</strong> Solving for the unknown hydraulic heads from the last equation to the first by using the modified (A) and \(b\):
$$
\text{For each } i \text{ from } N \text{ down to 1}:
\quad h_i = \frac{b_i - A_{i,i+1} \cdot h_{i+1}}{A_{ii}}
$$</li>
</ul>
<p>Each iteration checks for convergence and, if necessary, the time step is adjusted to ensure accurate and stable solutions.</p>
</div>
          
          
        </div>
      </section>
      
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  document.querySelectorAll('.book-sidebar a').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        window.scrollTo({
          top: targetElement.offsetTop - 10,  
          behavior: 'smooth'
        });
      }
    });
  });
});
</script>


    </main>
    <div id="footer" class="container mt-5">
  <footer class="site-footer text-center bg-light py-4">
      <p></p>
      <p><a href="/privacy-policy">Privacy Policy</a></p>

      
      <div class="flag-counter mt-3">
        <a href="https://info.flagcounter.com/0BBH">
            <img src="https://s11.flagcounter.com/count2/0BBH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_0/pageviews_0/flags_0/percent_0/" alt="Flag Counter" border="0">
        </a>
      </div>            


      <div class="social-icons mt-3">
          <a href="https://www.youtube.com/channel/UCbxAVXpc2pc2sjjn64oPdIQ" target="_blank" class="text-danger mx-3">
              <i class="fab fa-youtube fa-2x"></i>
          </a>
          <a href="https://www.linkedin.com/company/cluster-of-excellence-phenorob/" target="_blank" class="text-primary mx-3">
              <i class="fab fa-linkedin fa-2x"></i>
          </a>
          <a href="https://twitter.com/your_twitter_handle" target="_blank" class="text-info mx-3">
              <i class="fab fa-twitter fa-2x"></i>
          </a>
      </div>
  </footer>
</div>


    
</body>
</html>
