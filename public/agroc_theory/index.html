<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroC Numerical Implementation</title>
    <meta name="description" content="">
    <head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  
  
  
  
   
   
   
   

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/members.css">
  <link rel="stylesheet" href="/css/single.css"> 
  <link rel="stylesheet" href="/css/back2top.css"> 
  <link rel="stylesheet" href="/css/dropdown.css"> 
  <link rel="stylesheet" href="/css/research-areas.css">
 
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
</head>
    
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>  
</head>
<body>        
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  
  <a class="navbar-brand" href="https://www.phenorobdaa.de/">
      <img src="/images/DAA.png" alt="Logo" style="max-height: 75px;">
  </a>

  <div class="d-flex flex-grow-1 justify-content-center d-none d-md-block">
    <div class="text-center">
        <h1 class="mb-0 display-4">PhenoRob Digital Agricultural Avatar (DAA)</h1>
        <h2 class="h5 mb-0">(Process Based Models for the Future of Crop Production)</h2>
    </div>
  </div>


  
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
  </button>

  
  <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
      <ul class="navbar-nav ml-auto">
          
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="link2Dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  DAA
              </a>
              <div class="dropdown-menu" aria-labelledby="link2Dropdown">
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//about/">About</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//videos/">Videos</a>
                  
              </div>
          </li>

          
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="toolsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Modelling
              </a>
              <div class="dropdown-menu" aria-labelledby="toolsDropdown">
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//tools/">Our Main Tools</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//couple/">Coupled Models</a>
                  
                      
                      
                          
                      
                      <a class="dropdown-item" href="https://www.phenorobdaa.de//model_info/">Model Info Zone</a>
                  
              </div>
          </li>

            
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="link1Dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Research
            </a>
            <div class="dropdown-menu" aria-labelledby="link1Dropdown">
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//research-areas/">Research Area</a>
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//members/">Research Team</a>
                
                    
                    
                        
                    
                    <a class="dropdown-item" href="https://www.phenorobdaa.de//publication/">Publications</a>
                
            </div>
            </li>

          
           <li class="nav-item">
              <a class="nav-link" href="/members/" target="_blank">Contact</a>
           </li>
      </ul>
  </div>
</nav>
    
    <main>
        
         
         <script src="https://www.phenorobdaa.de/js/slider.js"></script> 
        
<style>
  .book-sidebar {
    position: fixed;
    top: 100px;
    left: 0;
    width: 250px;
    height: 100vh;
    overflow-y: auto;
    padding: 1rem;
    border-right: 1px solid #ccc;
  }

  @media (max-width: 768px) {
    .book-sidebar {
      width: 0;
      border-right: none;
    }
  }

  .book-content {
      margin-left: 270px;
      padding: 1rem;
      padding-right: calc(10px + 2vw);
  }

  @media (min-width: 992px) {
      .book-content {
          padding-right: 200px;
      }
  }

  @media (max-width: 768-px) {
      .book-content {
          padding-right: 50px;
      }
  }

  .card {
    margin-bottom: 2rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .figure img {
    max-width: 80%;
    height: auto;
  }

  .figure-caption {
    margin-top: 0.5rem;
    font-style: italic;
  }
</style>

<div class="container-fluid mt-5">
  <div class="row">
    
    <div class="col-md-3 book-sidebar">
      <h4 class="sidebar-heading">Contents</h4>
      <ul class="nav flex-column">
        
        <li class="nav-item">
          <a class="nav-link" href="#water-flow-richards-equation">Water Flow: Richard&#39;s Equation</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#discretization-of-richards-equation">Discretization of Richard&#39;s Equation</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#richards-solver">Richard&#39;s Solver</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#plant-growth-and-development-model">Plant Growth and Development Model</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#carbon-cycling-and-co2-production">Carbon Cycling and CO2 Production</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#nitrogen-cycling-module">Nitrogen Cycling Module</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#solute-transport-module">Solute Transport Module</a>
        </li>
        
      </ul>
    </div>

    
    <div class="col-md-9 ml-auto book-content">
      
      <section id="water-flow-richards-equation" class="card">
        <div class="card-body">
          <h2 class="card-title">Water Flow: Richard&#39;s Equation</h2>
          <div class="card-text"><p>In the Watflow module of AgroC, Richard&rsquo;s equation is solved to simulate how water moves through unsaturated soils. In terms of water content, this equation can be written as:
$$
\frac{\partial \theta}{\partial t} = \nabla \cdot (K(h) \nabla h) + S
$$
where,</p>
<ul>
<li>\(\theta\) is the volumetric water content (dimensionless, typically expressed as m³/m³);</li>
<li>\(h\) is the hydraulic head (units: L, typically meters);</li>
<li>\(t\) represents time (seconds or days);</li>
<li>\(K(h)\) is the hydraulic conductivity, a function of the hydraulic head (units: L/T, typically m/s);</li>
<li>\(S\) represents sources or sinks of water such as root water uptake or irrigation (units: L³/L³/T, typically m³/m³/s);</li>
<li>The spatial derivatives are approximated using finite differences and the temporal derivative is handled via an implicit time-stepping method.</li>
</ul>
<p>In AgroC, we solve this equation by using advanced numerical techniques like Picard iteration for non-linear convergence and a Gauss-Siedel elimination technique to solve the resulting linear system of equations.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="discretization-of-richards-equation" class="card">
        <div class="card-body">
          <h2 class="card-title">Discretization of Richard&#39;s Equation</h2>
          <div class="card-text"><p>Richard&rsquo;s equation is numerically approximated using a finite difference method (FDM) for spatial discretization and an implicit time-stepping method for temporal discretization. Here is the detailed breakdown:</p>
<h4 id="finite-difference-method-fdm">Finite Difference Method (FDM)</h4>
<p>The differential equation:
$$
\frac{\partial \theta}{\partial t} = \nabla \cdot (K(h) \nabla h) + S
$$
is discretized for a computational grid point (i) as follows:
$$
\frac{\theta_i^{n+1} - \theta_i^n}{\Delta t} = \frac{K_{i+1/2}^{n+1} (h_{i+1}^{n+1} - h_i^{n+1}) - K_{i-1/2}^{n+1} (h_i^{n+1} - h_{i-1}^{n+1})}{\Delta z^2} + S_i
$$
where:</p>
<ul>
<li>\(K_{i+1/2}^{n+1}\) and \(K_{i-1/2}^{n+1}\) represent the hydraulic conductivity values interpolated between nodes,</li>
<li>\(\Delta z\) is the distance between adjacent nodes (vertical discretization),</li>
<li>\(S_i\) is the source or sink term at node (i), including effects like root water uptake or irrigation.</li>
</ul>
<h4 id="handling-of-hydraulic-conductivity">Handling of Hydraulic Conductivity</h4>
<p>Hydraulic conductivity (K(h)) is a key non-linear component in Richard&rsquo;s equation and is dependent on the hydraulic head (h). In the discretization:
$$
K_{i+1/2}^{n+1} = \frac{K(h_{i+1}^{n+1}) + K(h_i^{n+1})}{2}
$$</p>
<h4 id="time-discretization">Time Discretization</h4>
<p>Time discretization is handled implicitly to ensure stability, especially given the non-linear nature of the soil moisture properties. The backward Euler method is used:
$$
\frac{\theta_{i}^{n+1} - \theta_{i}^n}{\Delta t}
$$</p>
<ul>
<li>where \(n\) indicates the time level.</li>
</ul>
<h4 id="picard-iteration-for-linearization">Picard Iteration for Linearization</h4>
<p>To manage the non-linear relationship between hydraulic head and hydraulic conductivity, Picard iteration is utilized:
$$
h_i^{n+1,k+1} = h_i^{n+1,k} + \Delta t \left( \nabla \cdot (K(h_i^{n+1,k}) \nabla h_i^{n+1,k}) + S_i \right)
$$</p>
<ul>
<li>Here, (k) represents the Picard iteration step within each time step, refining the head approximation iteratively until convergence.</li>
</ul>
</div>
          
          
        </div>
      </section>
      
      <section id="richards-solver" class="card">
        <div class="card-body">
          <h2 class="card-title">Richard&#39;s Solver</h2>
          <div class="card-text"><h4 id="gauss-elimination-for-linear-systems">Gauss Elimination for Linear Systems</h4>
<p>Gauss elimination is employed to solve linear systems formed from the finite difference discretization of Richard&rsquo;s equation. Here&rsquo;s a comprehensive step-by-step description of the entire Gauss elimination process, including the explicit definition and formation of matrix (A):</p>
<h5 id="formation-of-matrix-a">Formation of Matrix (A)</h5>
<p>Matrix (A) is formed from the discretization of Richard&rsquo;s equation. It consists of coefficients that account for the hydraulic conductivity between nodes and the storage or capacitance of each node:</p>
<ul>
<li>
<p>Diagonal Entries (Aii): These entries are formed based on the local node&rsquo;s hydraulic conductivity and its soil water capacitance. For node (i), the diagonal entry Aii is given by:
$$
A_{ii} = \frac{K_{i+1/2} + K_{i-1/2}}{\Delta z} + \frac{\text{Cap}_i \cdot \Delta z}{\Delta t}
$$
where:</p>
<ul>
<li>\(K_{i+1/2}\) and \(K_{i-1/2}\) are the conductivities at the interfaces with adjacent nodes,</li>
<li>\(\Delta z\) is the spatial discretization step,</li>
<li>\(\Delta t\) is the time step,</li>
<li>\(\text{Cap}_i\) is the soil water capacitance at node (i).</li>
</ul>
</li>
<li>
<p>Off-Diagonal Entries Aij: These entries represent the fluxes between node (i) and its adjacent nodes due to hydraulic conductivity:
$$
A_{i,i+1} = -\frac{K_{i+1/2}}{\Delta z}, \quad A_{i,i-1} = -\frac{K_{i-1/2}}{\Delta z}
$$
These terms account for the influence of neighboring nodes on node (i).</p>
</li>
</ul>
<h5 id="formation-of-vector-b">Formation of Vector (b)</h5>
<p>Vector (b) accounts for the water content changes and external sources or sinks at each node:
$$
b_i = \text{Cap}_i \cdot \frac{\theta_i^n}{\Delta t} + S_i \cdot \Delta z + \text{Boundary Contributions}
$$
Here, \(\theta_i^n\) is the previous time step&rsquo;s water content, and \(S_i\) represents sources or sinks such as root uptake or irrigation.</p>
<p><strong>Boundary Conditions:</strong></p>
<ul>
<li><strong>Top Boundary:</strong> Modify the first row of \(A\) and \(b\) depending on specified atmospheric or flux conditions.</li>
<li><strong>Bottom Boundary:</strong> Modify the last row of \(A\) and \(b\) based on seepage or bottom flux conditions.</li>
</ul>
<h5 id="forward-elimination-and-back-substitution">Forward Elimination and Back Substitution</h5>
<p>The solution process involves:</p>
<ul>
<li><strong>Forward Elimination:</strong> Modifying matrix \(A\) to upper triangular form and adjusting vector (b) to reflect these transformations, preparing for back substitution.
$$
\text{For each } i \text{ from 3 to } N-1:
\quad \text{if } |A_{i-1,i-1}| &gt; \epsilon:
\quad \quad b_i = b_i - \frac{b_{i-1} \cdot A_{i,i-1}}{A_{i-1,i-1}}
\quad \quad A_{ii} = A_{ii} - \frac{A_{i,i-1}^2}{A_{i-1,i-1}}
\quad \text{else}:
\quad \quad \text{Print exception}
$$</li>
<li><strong>Back Substitution:</strong> Solving for the unknown hydraulic heads from the last equation to the first by using the modified (A) and \(b\):
$$
\text{For each } i \text{ from } N \text{ down to 1}:
\quad h_i = \frac{b_i - A_{i,i+1} \cdot h_{i+1}}{A_{ii}}
$$</li>
</ul>
<p>Each iteration checks for convergence and, if necessary, the time step is adjusted to ensure accurate and stable solutions.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="plant-growth-and-development-model" class="card">
        <div class="card-body">
          <h2 class="card-title">Plant Growth and Development Model</h2>
          <div class="card-text"><p>The Plants module in this code simulates crop growth, development, and interactions with the environment. It incorporates several key processes:</p>
<ol>
<li>Photosynthesis and Biomass Accumulation:
The model calculates daily gross CO2 assimilation (DTR) based on light interception and photosynthetic capacity:
$$
DTR = \int_{0}^{24} (F_s \cdot A_s + F_o \cdot A_o) dt
$$
where:</li>
</ol>
<ul>
<li>$F_s$ and $F_o$ are fractions of shaded and sunlit leaves</li>
<li>$A_s$ and $A_o$ are assimilation rates for shaded and sunlit leaves</li>
</ul>
<ol start="2">
<li>
<p>Crop Development:
Development stage (DVS) is calculated based on temperature and photoperiod:
$$
\frac{dDVS}{dt} = f(T) \cdot f(P) \cdot f(V)
$$
where $f(T)$, $f(P)$, and $f(V)$ are functions of temperature, photoperiod, and vernalization, respectively.</p>
</li>
<li>
<p>Biomass Partitioning:
Assimilates are distributed among different plant organs (leaves, stems, roots, storage organs) based on development stage-dependent partitioning coefficients.</p>
</li>
<li>
<p>Leaf Area Index (LAI) Dynamics:
LAI growth is modeled as:
$$
\frac{dLAI}{dt} = SLA \cdot \frac{dW_{leaf}}{dt} - D_{leaf}
$$
where SLA is specific leaf area and $D_{leaf}$ represents leaf senescence.</p>
</li>
<li>
<p>Root Growth and Water Uptake:
Root growth is simulated, and water uptake is calculated using a sink term approach:
$$
S(z) = \alpha(h) \cdot S_{max}(z)
$$
where $\alpha(h)$ is a stress reduction function and $S_{max}(z)$ is the maximum potential uptake at depth z.</p>
</li>
<li>
<p>Evapotranspiration:
Potential evapotranspiration is partitioned into soil evaporation and plant transpiration based on LAI and crop coefficients.</p>
</li>
<li>
<p>Carbon Dioxide Assimilation (Farquhar Model):
When enabled, the Farquhar model is used to calculate CO2 assimilation rate (A):
$$
A = \min(A_c, A_j, A_e)
$$
where $A_c$, $A_j$, and $A_e$ are the Rubisco-limited, light-limited, and export-limited rates, respectively.</p>
</li>
<li>
<p>Crop Senescence and Harvest:
The model simulates crop senescence and allows for multiple growing seasons with harvest events.</p>
</li>
</ol>
<p>This comprehensive plant growth model integrates various physiological processes to simulate crop development, growth, and yield in response to environmental conditions and management practices.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="carbon-cycling-and-co2-production" class="card">
        <div class="card-body">
          <h2 class="card-title">Carbon Cycling and CO2 Production</h2>
          <div class="card-text"><p>The Carbon module in AgroC simulates carbon cycling and CO2 production in the soil. It uses a multi-pool approach similar to the RothC model, with the following key components:</p>
<h4 id="carbon-pools">Carbon Pools</h4>
<p>AgroC considers five main carbon pools:</p>
<ul>
<li>DPM (Decomposable Plant Material)</li>
<li>RPM (Resistant Plant Material)</li>
<li>BIO (Microbial Biomass)</li>
<li>HUM (Humus)</li>
<li>IOM (Inert Organic Matter)</li>
</ul>
<h4 id="co2-production">CO2 Production</h4>
<p>The total CO2 production (g0) is calculated as the sum of heterotrophic respiration (g0h) and root respiration (g0r):
$$
g0(i) = g0r(i) + g0h(i)
$$
where i represents the soil node.</p>
<h4 id="environmental-factors">Environmental Factors</h4>
<p>CO2 production is influenced by several environmental factors, each represented by a reduction function:</p>
<ul>
<li>fS1: Depth reduction</li>
<li>fS2: Soil moisture reduction</li>
<li>fS3: Temperature reduction</li>
<li>fS4: CO2 concentration reduction</li>
</ul>
<h4 id="temperature-reduction-fs3">Temperature Reduction (fS3)</h4>
<p>The temperature reduction factor is calculated using various models, including the SOILCO2 model:
$$
fS3 = \exp\left(\frac{B1(T - T_{ref})}{(T + 273.15)(T_{ref} + 273.15)}\right)
$$
where T is the soil temperature, T_{ref} is the reference temperature, and B1 is an empirical parameter.</p>
<h4 id="moisture-reduction-fs2">Moisture Reduction (fS2)</h4>
<p>Various models are available for moisture reduction, including the CENTURY model:
$$
fS2 = \frac{1}{1 + 30 \exp(-8.5 \frac{\theta - \theta_r}{\theta_s - \theta_r})}
$$
where θ is the volumetric water content, θ_r is the residual water content, and θ_s is the saturated water content.</p>
<h4 id="carbon-pool-dynamics">Carbon Pool Dynamics</h4>
<p>The dynamics of each carbon pool are governed by first-order kinetics:
$$
\frac{dC_i}{dt} = -k_i C_i fS2 \cdot fS3 \cdot fS4
$$
where C_i is the carbon content of pool i, and k_i is the decomposition rate constant for that pool.</p>
<p>This module allows for detailed simulation of carbon cycling and CO2 production in soils, taking into account various environmental factors and their complex interactions.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="nitrogen-cycling-module" class="card">
        <div class="card-body">
          <h2 class="card-title">Nitrogen Cycling Module</h2>
          <div class="card-text"><p>The Nitrogen module in AgroC simulates the cycling of nitrogen in the soil-plant system. The module solves a set of coupled differential equations representing various nitrogen transformation processes:</p>
<h4 id="nitrogen-pools-and-forms">Nitrogen Pools and Forms</h4>
<p>The module considers organic nitrogen pools (litter, manure, humus) and inorganic forms (urea, ammonium, nitrate).</p>
<h4 id="key-processes-and-equations">Key Processes and Equations</h4>
<ol>
<li>
<p>Urea Hydrolysis:
$$
\frac{d[Urea]}{dt} = -k_{hyd} \cdot f(T) \cdot f(\theta) \cdot [Urea]
$$</p>
</li>
<li>
<p>Nitrification:
$$
\frac{d[NH_4^+]}{dt} = -k_{nit} \cdot f(T) \cdot f(\theta) \cdot [NH_4^+]
$$</p>
</li>
<li>
<p>Denitrification:
$$
\frac{d[NO_3^-]}{dt} = -k_{den} \cdot f(T) \cdot f(\theta) \cdot f(WFPS) \cdot [NO_3^-]
$$
where WFPS is the water-filled pore space.</p>
</li>
<li>
<p>Volatilization:
$$
\frac{d[NH_3]}{dt} = k_{vol} \cdot f(T) \cdot f(\theta) \cdot [NH_4^+]
$$</p>
</li>
<li>
<p>Mineralization-Immobilization:
$$
\frac{dN_{org}}{dt} = -k \cdot f(T) \cdot f(\theta) \cdot N_{org} \cdot \left(\frac{C/N_{org}}{C/N_{ref}} - 1\right)
$$
where C/N_org is the C/N ratio of the organic matter and C/N_ref is a reference C/N ratio.</p>
</li>
<li>
<p>Plant Uptake:
Combines passive uptake (mass flow) and active uptake (diffusion):
$$
U_{total} = U_{passive} + U_{active}
$$
where U_passive is proportional to water uptake and concentration, and U_active follows Michaelis-Menten kinetics.</p>
</li>
<li>
<p>Biological Nitrogen Fixation:
$$
N_{fix} = R_{fix} \cdot f(T) \cdot f(\theta) \cdot f(N_{stress})
$$
where R_fix is the potential fixation rate and f(N_stress) represents plant N status.</p>
</li>
</ol>
<h4 id="environmental-factors">Environmental Factors</h4>
<p>Temperature and moisture effects are modeled using reduction functions:
$$
f(T) = Q_{10}^{(T-T_{ref})/10}
$$
$$
f(\theta) = \left(\frac{\theta - \theta_{min}}{\theta_{opt} - \theta_{min}}\right)^{\beta}
$$</p>
<h4 id="system-of-differential-equations">System of Differential Equations</h4>
<p>The module solves a system of coupled differential equations for each nitrogen pool and form:
$$
\frac{d[N_i]}{dt} = \sum_{j} (Input_j - Output_j)
$$
where [N_i] represents the concentration of each nitrogen form, and Input_j and Output_j are the various transformation processes affecting that form.</p>
<p>This system of equations is solved numerically to simulate the dynamic nitrogen cycling in the soil-plant system, accounting for various transformation processes and environmental influences.</p>
</div>
          
          
        </div>
      </section>
      
      <section id="solute-transport-module" class="card">
        <div class="card-body">
          <h2 class="card-title">Solute Transport Module</h2>
          <div class="card-text"><p>The Solute module in AgroC simulates the transport and reactions of various solutes in the soil-plant system. The core of this module is the solution of the advection-dispersion-reaction equation:</p>
<p>$$
\frac{\partial (\theta R C)}{\partial t} = \nabla \cdot (\theta D \nabla C) - \nabla \cdot (q C) + S
$$</p>
<p>where:</p>
<ul>
<li>θ is the volumetric water content (dimensionless)</li>
<li>R is the retardation factor (dimensionless)</li>
<li>C is the solute concentration (M/L³)</li>
<li>D is the dispersion coefficient (L²/T)</li>
<li>q is the water flux (L/T)</li>
<li>S represents source/sink terms (M/L³/T)</li>
</ul>
<p>The dispersion coefficient D is calculated as:</p>
<p>$$
D = \alpha |v| + D_w \tau_w + \frac{\theta_g}{\theta_w} D_g H \tau_g
$$</p>
<p>where:</p>
<ul>
<li>α is the dispersivity (L)</li>
<li>v is the pore water velocity (L/T)</li>
<li>D_w and D_g are molecular diffusion coefficients in water and gas phases (L²/T)</li>
<li>τ_w and τ_g are tortuosity factors (dimensionless)</li>
<li>H is Henry&rsquo;s constant (dimensionless)</li>
<li>θ_g and θ_w are gas and water contents (dimensionless)</li>
</ul>
<p>The module incorporates various adsorption models, including:</p>
<ol>
<li>Linear isotherm: S = K_d C</li>
<li>Freundlich isotherm: S = K_f C^n</li>
<li>Langmuir isotherm: S = (Q_m K C) / (1 + K C)</li>
</ol>
<p>where S is the adsorbed concentration, and K_d, K_f, n, Q_m, and K are empirical parameters.</p>
<p>For non-equilibrium transport, the module uses a two-site sorption model or a dual-porosity model, introducing additional equations for the kinetic sorption or mass transfer between mobile and immobile water.</p>
<p>Root solute uptake is modeled as a combination of passive and active uptake:</p>
<p>$$
S_{uptake} = \alpha_w S_{passive} + S_{active}
$$</p>
<p>where α_w is related to water uptake, and S_active follows Michaelis-Menten kinetics.</p>
<p>The module solves these equations using finite difference spatial discretization and implicit time-stepping, with options for upstream weighting in advection-dominated scenarios.</p>
</div>
          
          
        </div>
      </section>
      
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  document.querySelectorAll('.book-sidebar a').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        window.scrollTo({
          top: targetElement.offsetTop - 10,  
          behavior: 'smooth'
        });
      }
    });
  });
});
</script>


    </main>
    <div id="footer" class="container mt-5">
  <footer class="site-footer text-center bg-light py-4">
      <p></p>
      <p><a href="/privacy-policy">Privacy Policy</a></p>

      
      <div class="flag-counter mt-3">
        <a href="https://info.flagcounter.com/0BBH">
            <img src="https://s11.flagcounter.com/count2/0BBH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_0/pageviews_0/flags_0/percent_0/" alt="Flag Counter" border="0">
        </a>
      </div>            


      <div class="social-icons mt-3">
          <a href="https://www.youtube.com/channel/UCbxAVXpc2pc2sjjn64oPdIQ" target="_blank" class="text-danger mx-3">
              <i class="fab fa-youtube fa-2x"></i>
          </a>
          <a href="https://www.linkedin.com/company/cluster-of-excellence-phenorob/" target="_blank" class="text-primary mx-3">
              <i class="fab fa-linkedin fa-2x"></i>
          </a>
          <a href="https://twitter.com/your_twitter_handle" target="_blank" class="text-info mx-3">
              <i class="fab fa-twitter fa-2x"></i>
          </a>
      </div>
  </footer>
</div>


    
</body>
</html>
