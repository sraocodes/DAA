---
title: "CPlantBox"
description: "Here we describe the codes of CPlantBox implementation as well as the instruction to install it along with its
              inputs and outputs from developer's perspective"
layout: "model_files"
sections:
sections:
  - section_name: "Structural Module"
    description: "The structural module contains code that simulates plant growth and morphology within the CPlantBox framework. It defines the characteristics and behavior of various plant organs like roots, stems, leaves, and seeds. Additionally, it handles tropism responses, enabling plants to adjust their growth direction in response to environmental cues. In essence, this module forms the basis for realistic plant growth simulations."
    table:
      title: "Description of C++ codes in Structural Module"
      headers: ["File", "Functionality", "Variables", "I/O"]
      rows:
        - ["[Leaf.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Leaf.cpp)", "Manages leaf growth and development, covering creation, parameter computation, and visualization. Includes geometric properties and connectivity.", "Leaf identification, parameters, growth factors, geometry, tropism, connectivity.", "Input: Growth parameters, environment. Output: Leaf properties."]
        - ["[MappedOrganism.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/MappedOrganism.cpp)", "Handles plant structural management, including 3D soil grid mapping. Oversees initialization and simulation of root and shoot systems.", "Nodes, segments, radii, organ types, soil index, plant parameters, exchange zones.", "Input: Plant structure, soil parameters. Output: Plant structure, growth data."]
        - ["[Organ.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Organ.cpp)", "Serves as a base class for plant organs (seeds, roots, stems, leaves), handling their development, geometry, and tree structure.", "Nodes, segments, organ tree, parameters, type, age, status.", "Input: Development parameters, time. Output: Organ structure, growth, geometry."]
        - ["[Organism.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Organism.cpp)", "Provides simulation interface and manages OrganRandomParameters. Supports RSML and handles global node and organ index counters.", "Organ parameters, node/segment geometry, indices, RNG.", "Input: Simulation parameters. Output: Organism development, geometry, RSML."]
        - ["[Plant.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Plant.cpp)", "Controls plant model simulation, managing tropisms, growth functions, and post-processing. Sets up simulation callbacks for tropisms and growth.", "Tropisms, growth functions, soil lookup, parameters, state, callbacks.", "Input: Initialization, growth parameters. Output: Growth, utilities."]
        - ["[Root.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Root.cpp)", "Describes root growth, managing the creation of lateral roots and root-specific parameters. Provides capabilities for time-span growth simulation.", "Root parameters, types, state, node creation, tropism.", "Input: Growth parameters, environment. Output: Root growth, new nodes/roots."]
        - ["[RootDelay.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/RootDelay.cpp)", "Focuses on delayed lateral root growth, inheriting from Root class. Implements delay-based lateral root emergence.", "Root delay parameters, lateral root creation, root structure.", "Input: Growth parameters with delay. Output: Delayed root growth, structure."]
        - ["[RootSystem.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/RootSystem.cpp)", "Manages the entire root system, including base roots and parameters. Inherits from Organism class, integrating various root dynamics.", "Root parameters, tropisms, growth functions, state, tools.", "Input: Configuration, simulation parameters. Output: Root system growth, analysis."]
        - ["[Seed.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Seed.cpp)", "Defines the Seed class, representing the plant's seed and managing the development of various organs. Integrates with plant organism structure.", "Seed development, organ management, integration with plant.", "Input: Plant configuration, organ parameters. Output: Organ initialization."]
        - ["[Stem.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/Stem.cpp)", "Handles stem growth and development, including lateral stem emergence and parameter computation. Supports various growth scenarios.", "Growth simulation, lateral management, parameter computation, growth modes.", "Input: Parameters, growth data. Output: Stem growth, data, parameters."]
        - ["[organparameter.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/organparameter.cpp)", "Central to configuring organ types in plants. Manages organ-specific and randomized parameters for simulation variability.", "Organ type setup, parameter handling, random parameter management.", "Input: Organism data, configuration. Output: Organ parameters, characteristics."]
        - ["[rootparameter.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/rootparameter.cpp)", "Defines root-specific parameters and functionalities, handling configurations for growth dynamics and tropism.", "Root type setup, growth dynamics, tropism, distance management.", "Input: Root data, growth configuration. Output: Root parameters, characteristics."]
        - ["[seedparameter.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/seedparameter.cpp)", "Handles seed-specific parameters, crucial for modeling early plant development and root system initiation.", "Seed positioning, root emergence, crown configuration, tiller parameters.", "Input: Seed data, configuration. Output: Seed parameters, development."]
        - ["[stemparameter.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/structural/stemparameter.cpp)", "Manages stem-specific parameters, key to modeling stem growth, branching, and structural characteristics.", "Growth dynamics, branching, tropism, lifespan, nodal functions.", "Input: Stem data, growth parameters. Output: Stem parameters, characteristics."]
        - ["[tropism.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/behavioral/tropism.cpp)", "Defines tropism behaviors, implementing mechanisms like gravitropism and hydrotropism, crucial for realistic plant growth simulation.", "Various tropisms, environmental response mechanisms.", "Input: Environmental stimuli, growth parameters. Output: Growth direction, tropism responses."]

  - section_name: "Functional Module"
    description: "The functional module in CPlantBox encompasses a suite of Python scripts that provide models and calculations related to plant-soil-water interactions. This includes implementations of soil hydraulic models, root water uptake models, and other processes essential for simulating how plants interact with their environment. The module leverages scientific models such as the Van Genuchten model for soil water retention and hydraulic conductivity, and includes tools for creating soil parameter lookup tables, computing root conductivities, and more."
    table:
      title: "Description of Python Scripts in Functional Module"
      headers: ["File", "Functionality", "Variables", "Input/Output"]
      rows:
        - ["[Photosynthesis.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/Photosynthesis.cpp)", "Handles the simulation of photosynthesis processes in plants, including water flux, carbon assimilation, and stomatal opening. It involves solving coupled linear systems, error computation, and managing environmental interactions.", "MappedPlant object, initial guesses for xylem water potential and intracellular CO2 partial pressure, environmental variables like atmospheric humidity and temperature, simulation parameters like soil matric potentials and soil conductivities, error tracking variables, and arrays for storing various computed values (e.g., photosynthesis rate, stomatal conductance, intercellular CO2 concentration).", "Input: Environmental conditions, simulation parameters, plant structure data. Output: Updated plant physiological states, including water potential, gas exchange rates, and related photosynthetic properties."]
        - ["[Perirhizal.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/Perirhizal.cpp)", "Calculates outer segment radii for plant roots in different scenarios, ensuring that the summed segment volumes per cell equals the cell volume. It supports calculations based on segment volume, surface, or length.", "Cylinder volume type, optional volumes per cell, segment lengths, cell and segment IDs, and radii. Variables to store calculated outer radii and cell volumes.", "Input: Volume type (segment volume, surface, or length), optional cell volumes. Output: Vector of calculated outer radii for root segments."]
        - ["[CellVariablemod.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/CellVariablemod.py)", "Enhances plant physiological simulation capabilities by extending and modifying FiPy library classes. These custom classes are designed to accurately compute and manage plant-related variables, such as water and nutrient transport within plant tissues. Key features include gradient calculation, divergence computation, and efficient handling of mesh-based variables, which are crucial for simulating complex biophysical interactions within plants.", "Custom CellVariablemod and FaceVariablemod classes for representing plant physiological properties, _AddOverFacesVariablemod for surface integrals, _FaceGradVariablemod and _ArithmeticCellToFaceVariablemod for gradients and arithmetic operations in plant simulations, mesh attributes, cell and face orientations, area calculations, volume computations.", "Input: Plant tissue structure data and physical parameters for simulations. Output: Computed variables representing transport and flow properties within plant tissues."]
        - ["[ExudationModel.h](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/ExudationModel.h)", "Implements a model for simulating root exudation in plants. This includes calculating the distribution of exudates in the soil, accounting for factors such as root growth dynamics, soil properties, and exudate diffusion. The model supports various integration methods to represent root growth and exudation patterns, and applies numerical methods for simulating exudate dispersion in the soil.", "Model parameters (Q, Dl, theta, R, k, l), Numerical parameters (grid, type, n0, thresh13, calc13, observationRadius), Methods for calculating exudation and handling root system data, Variables for integration and root system characteristics (age, stop time, tip positions, directions).", "Input: Plant root system data, simulation time, and model parameters. Output: Distribution of root exudates in the soil over the simulation period."]
        - ["[HydraulicsDoussan.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/HydraulicsDoussan.py)", "Implements the root hydraulic model following Doussan et al., focusing on the simulation of water movement within the root system. This includes computation of the root system conductivity, axial fluxes, and interaction with the soil environment. The model calculates various hydraulic properties and fluxes based on the root system's geometry, age-dependent conductivities, and environmental conditions.", "Root system (rs), incidence and soil matrices, conductivity functions (kr_f and kx_f), simulation time parameters, root xylem potentials (rx), hydraulic properties like axial flux and transpirational flux, methods for solving the hydraulic system.", "Input: Root system structure, environmental conditions, and simulation time. Output: Hydraulic properties such as root system conductivity, axial fluxes, and xylem potentials."]
        - ["[Leuning.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/Leuning.py)", "Implements the Leuning model for simulating water movement within plant xylems, stomatal aperture, and net assimilation rate. The model integrates root water uptake with leaf-level photosynthetic processes, including calculations of stomatal conductance, internal CO2 concentration, and leaf water potential. The model is primarily based on the works of Tuzet, Dewar, and Lu, and is capable of handling various environmental conditions and plant physiological parameters.", "Simulation parameters (e.g., Qlight, VPD, Tl, soil matric potentials), hydraulic properties (e.g., xylem conductivities, root xylem potentials), leaf-level photosynthetic parameters (e.g., internal CO2 concentration, stomatal conductance), and methods for computing water fluxes and assimilation rates.", "Input: Plant structure data, environmental conditions, and simulation time. Output: Hydraulic and photosynthetic properties, including xylem potentials, stomatal conductance, and assimilation rates."]
        - ["[van_genuchten.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/van_genuchten.py)", "Implementation of the Mualem - van Genuchten model for soil water retention and hydraulic conductivity.", "Methods for converting between pressure head and hydraulic conductivity, calculating water content, effective saturation, and hydraulic conductivity.", "Input: Soil water content or pressure head, soil parameters (theta_R, theta_S, alpha, n, Ksat). Output: Pressure head, water content, effective saturation, and hydraulic conductivity."]
        - ["[root_conductivities.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/root_conductivities.py)", "Provides helper functions to define age-dependent tabular values for root conductivities.", "Initialization of conductivities with various scenarios including constant and age-dependent values.", "Utilized in setting up root hydraulic properties for growth simulations."]
        - ["[phloem_flux.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/phloem_flux.py)", "Wrapper for simulating phloem flux and related processes within the plant.", "Methods for calculating segment ages, node indices, organ types, and hydraulic properties.", "Input: Plant root system data, simulation time, model parameters (e.g., initial xylem water potential, initial intracellular CO2 partial pressure). Output: Phloem flux simulation results, including calculated fluxes and related plant physiological properties."]
        - ["[Mesh1Dmod.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/Mesh1Dmod.py)", "Enhances the FiPy library's Mesh1D class to support 3D network modeling, particularly for root systems in plant simulations. This modified mesh class is capable of handling complex 3D structures with specific adaptations for plant-related calculations, such as cell volumes, face normals, and cell centers based on root geometry. It includes specialized methods to accurately calculate geometric properties relevant to plant physiology and root-soil interactions.", "Adapted mesh properties (radii, length, vertex coordinates, face normals), methods for computing cell volumes, face areas, face normals, and other geometric aspects specific to 3D root network structures.", "Input: Geometric and structural data of the plant's root system. Output: Adapted mesh properties suitable for detailed plant physiological simulations and root-soil interaction modeling."]
        - ["[Perirhizal.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/Perirhizal.py)", "Enhances the analysis of perirhizal zones in plant root systems. The class 'PerirhizalPython' wraps around 'MappedSegments' and provides functions for retrieving information on perirhizal zones of single segments. Capabilities include calculating soil volumes, bounding box dimensions, identifying nodes within specified regions, and computing densities (length, surface, or volume) in the perirhizal zones. The class also includes methods for mirroring nodes, aggregating segment parameters, and generating outer radii based on Voronoi diagrams.", "Soil volume cells, bounding box dimensions, perirhizal zone densities, segment parameters, outer radii calculations, methods for handling 3D Voronoi diagrams and bounding Voronoi meshes.", "Input: Root system segment data and soil volume information. Output: Detailed analysis of perirhizal zones including density measurements, outer radii, and Voronoi mesh information."]
        - ["[XylemFlux.cpp](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/XylemFlux.cpp)", "C++ based module for handling xylem flux, soil fluxes, and segment fluxes.", "Functions for assembling linear systems, computing segment and soil fluxes, and handling conductivity settings.", "Integral for comprehensive simulation of water flow within plant xylem."]
        - ["[bresenham3D.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/bresenham3D.py)", "Implements the 3D Bresenham's algorithm for generating points on a line in 3D space.", "Bresenham3D function for line drawing, sphere function for creating spherical structures.", "Input: x1, y1, z1, x2, y2, z2: Coordinates of two points defining the line in 3D space. Output: List of points representing the line drawn between the two input points in 3D space."]
        - ["[xylem_flux.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/xylem_flux.py)", "Implements a comprehensive model for simulating water movement within plant xylems, including axial and radial flux calculations, linear system setup and solving, consideration of matric potentials, soil conductivity, and age-dependent conductivities. Provides utilities for RSML file reading, boundary condition application, and model testing.", "Root system configuration, hydraulic properties, simulation parameters, node and segment information, flux values, soil characteristics, computational matrices.", "Input: RSML files for root system structure. Output: Calculated xylem pressures, flux values, hydraulic properties, visualization and debugging information."]
        - ["[StomataModel.py](https://github.com/Plant-Root-Soil-Interactions-Modelling/CPlantBox/blob/master/src/functional/StomataModel.py)", "A hybrid flux solver for modeling stomatal conductance and water movement in xylems, following Meunier et al. Integrates with C++ components in CPlantBox for enhanced calculations.", "PAR (Photosynthetically Active Radiation), VPD (Vapor Pressure Deficit), air and leaf temperature, optimal temperature, and soil matric potentials.", "Input: Root system data, environmental factors like PAR, VPD, and temperatures. Output: Calculated root xylem pressure and stomatal conductance for each leaf segment."]




---
